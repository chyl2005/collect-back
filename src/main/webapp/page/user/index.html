<div class="row" id="table">
    <div class="col-xs-12">
        <vtable>

        </vtable>

        <vpage>

        </vpage>
    </div>
</div>


<script type="text/x-template" id="table-template">

    <table id="simple-table" class="table  table-bordered table-hover">
        <thead>
        <tr>
            <th class="center">
                <label class="pos-rel">
                    <input type="checkbox" class="ace">
                    <span class="lbl"></span>
                </label>
            </th>
            <th>账号</th>
            <th>姓名</th>
            <th class="hidden-480">角色</th>

            <th>
                <i class="ace-icon fa fa-clock-o bigger-110 hidden-480"></i>
                注册时间
            </th>
            <th>状态</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <tr v-for="item in userList">
            <td class="center">
                <label class="pos-rel">
                    <input type="checkbox" class="ace">
                    <span class="lbl"></span>
                </label>
            </td>
            <td> {{item.userName}}</td>
            <td>{{item.trueName}}</td>
            <td class="hidden-480">{{item.roleName}}</td>
            <td>{{item.gmtCreated}}</td>
            <td>{{item.status}}</td>

            <td>
                <div class="hidden-sm hidden-xs btn-group">
                    <button class="btn btn-xs btn-success">
                        <i class="ace-icon fa fa-check bigger-120"></i>
                    </button>

                    <button class="btn btn-xs btn-info" @click="edit(item)">
                        <i class="ace-icon fa fa-pencil bigger-120"></i>
                    </button>

                    <button class="btn btn-xs btn-danger" @click="del(item)">
                        <i class="ace-icon fa fa-trash-o bigger-120"></i>
                    </button>

                    <button class="btn btn-xs btn-warning">
                        <i class="ace-icon fa fa-flag bigger-120"></i>
                    </button>
                </div>


            </td>
        </tr>
        </tbody>
    </table>

</script>


<script type="text/x-template" id="vpage">
    <ul class="pagination pull-right no-margin">
        <li class="prev disabled">
            <a href="#">
                <i class="ace-icon fa fa-angle-double-left"></i>
            </a>
        </li>

        <li class="active">
            <a href="#">1</a>
        </li>

        <li>
            <a href="#">2</a>
        </li>

        <li>
            <a href="#">3</a>
        </li>

        <li class="next">
            <a href="#">
                <i class="ace-icon fa fa-angle-double-right"></i>
            </a>
        </li>
    </ul>
</script>


<script type="text/javascript">
    Vue.component('vtable', {
        template: '#table-template',

        data: function () {
            var datas = {
                userList: [],
                pageCur: 1,
                pageSize: 10,
                url: "/back/user/list"
            };
            return datas;
        },
        created: function () {
            this.loadData();
        },
        methods: {
            //加载数据
            loadData: function () {
                var startRow = (this.pageCur - 1) * this.pageSize;
                this.$http.post(this.url, {'pageSize': this.pageSize, 'startRow': startRow}, {emulateJSON: true}).then(response => {
                    if (response.body.data.datas != null) {
                        response.body.data.datas.forEach((item) => {
                            var data = {};
                            data.userId = item.userId;
                            data.userName = item.userName;
                            data.trueName = item.trueName;
                            data.gmtCreated = getSmpFormatDateByLong(item.gmtCreated, true);
                            data.status = item.isDel == 0 ? "未刪除" : "已刪除";
                            this.userList.push(data);
                        });

                    }
                    console.log(JSON.stringify(JSON.stringify(this.userList)))
                }, response => {

                });
            }
        }
    });
    // start app
    new Vue({
        el: '#table'
    })


    // 分页方法 element jquery selector
    function paginator(element, currentPage, pageSize, totalCount, url) {
        var pageCount = Math.ceil(totalCount / pageSize);
        var options = {
            currentPage: currentPage,
            totalPages: pageCount,
            bootstrapMajorVersion: 3,
            alignment: "right",
            numberOfPages: 5,
            size: "normal",
            itemTexts: function (type, page, current) {
                switch (type) {
                    case "first":
                        return "首页";
                    case "prev":
                        return "上一页";
                    case "next":
                        return "下一页";
                    case "last":
                        return "尾页";
                    case "page":
                        return page;
                }
            },
            onPageClicked: function (event, originalEvent, type, page) {
                // 加载数据
                loadData(page, pageSize, url);
                pageCur = page;
            }
        }
        // 渲染分页模块
        $(element).bootstrapPaginator(options);
    }
</script>